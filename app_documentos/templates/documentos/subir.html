{% extends 'base.html' %}
{% load static %}

{% block title %}üìÑ Subir documento{% endblock %}

{% block content %}
<div class="card-dark" style="border-radius: 16px; padding: 2rem;">
  <div style="margin-bottom: 1.5rem;">
    <a href="{% url 'documentos_lista' %}" class="button-nav">‚Üê Volver atr√°s</a>
  </div>

  <h2 style="margin-bottom: 1rem;">üìÑ Subir documentos</h2>

  <form method="post" enctype="multipart/form-data" class="form-wrap">
    {% csrf_token %}

    <div class="form-group">
      <label for="{{ form.tipo.id_for_label }}" class="form-label">{{ form.tipo.label }}</label>
      {{ form.tipo }}
    </div>

    <div class="form-group">
      <label for="{{ form.titulo.id_for_label }}" class="form-label">{{ form.titulo.label }}</label>
      {{ form.titulo }}
    </div>

    <div class="form-group">
      <label for="{{ form.descripcion.id_for_label }}" class="form-label">{{ form.descripcion.label }}</label>
      {{ form.descripcion }}
    </div>

    <div class="form-group">
      <label for="{{ form.archivo.id_for_label }}" class="form-label">{{ form.archivo.label }}</label>
      {{ form.archivo }}
    </div>

    <!-- üìå Nuevo: Fecha del documento -->
    <div class="form-group">
      <label for="{{ form.fecha_documento.id_for_label }}" class="form-label">{{ form.fecha_documento.label }}</label>
      {{ form.fecha_documento }}
      <small style="color:#888">Fecha de emisi√≥n/registro del documento.</small>
    </div>

    <!-- üìå Nuevo: Checkbox para activar fecha l√≠mite -->
    <div class="form-group">
      <label style="display:flex; align-items:center; gap:.6rem;">
        {{ form.usa_fecha_limite }} ¬øAgregar fecha l√≠mite/alarma?
      </label>
      <small style="color:#888">Act√≠valo para documentos con vencimiento (ej. oficios de capacitaci√≥n).</small>
    </div>

    <!-- üìå Nuevo: Campo de fecha l√≠mite -->
    <div id="fecha-limite-wrapper" class="form-group">
      <label for="{{ form.fecha_limite.id_for_label }}" class="form-label">{{ form.fecha_limite.label }}</label>
      {{ form.fecha_limite }}
      <small style="color:#888">Selecciona la fecha l√≠mite si activaste la opci√≥n.</small>
    </div>

    <button type="submit" class="button">Guardar</button>
  </form>
</div>
{% endblock %}

{% block scripts %}
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const toggle = document.getElementById('id_usa_fecha_limite');
    const wrapper = document.getElementById('fecha-limite-wrapper');
    const fecha = document.getElementById('id_fecha_limite');

    function actualizarVisibilidad() {
      const activo = toggle.checked;
      wrapper.style.display = activo ? 'block' : 'none';
      if (!activo && fecha) {
        fecha.value = ''; // Limpia la fecha si no se usa l√≠mite
      }
    }

    if (toggle && wrapper) {
      actualizarVisibilidad();      // Estado inicial
      toggle.addEventListener('change', actualizarVisibilidad);
    }
  });
</script>
{% endblock %}

